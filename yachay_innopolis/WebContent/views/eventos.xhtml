<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:p="http://primefaces.org/ui" 
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html">
<h:head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<h:outputStylesheet library="css" name="styleser.css" />
<title>Crear Eventos</title>
</h:head>
<body>
<h:form enctype="multipart/form-data">  
    <p:menubar>
        <p:menuitem value="Crear Eventos" action="#{recursosBean.irTrecurso}" icon="ui-icon-pencil" />
        <p:menuitem value="Tipo Evento" action="#{recursosBean.irTrecurso}" icon="ui-icon-pencil" />
        <f:facet name="options">
            <p:commandButton type="button" value="Salir" icon="ui-icon-home" />
        </f:facet>
    </p:menubar>
</h:form>
<hr/>
<div class="div1">
<h:form id="form1">
	<p:growl id="message1" showDetail="true" />
	<p:panel id="panel1"  header="Registro de Eventos">
		<p:panelGrid  columns="2" >
			<h:outputText value="Nombre*:"/>
			<p:inputText required="true" id="nombr" value="#{eventosBean.nombre}" requiredMessage="Requerido nombre">
				<p:ajax  listener="#{eventosBean.asignarNombreImagen}" />
			</p:inputText>
			<h:outputText value="Descripción:"/>
			<p:inputTextarea required="true" id="cantid" value="#{eventosBean.descripcion}" requiredMessage="Requerido Descripcion">
			<f:validateLength minimum="10"/>
			</p:inputTextarea>
			<h:outputText value="Dirección:"/>
			<p:inputText  required="true" id="des" value="#{eventosBean.lugar}" requiredMessage="Requerido Dirección"></p:inputText>
			<h:outputText value="Costo:"/>
			<p:inputText  required="true" id="lugar" value="#{eventosBean.costo}" requiredMessage="Requerido Costo">
			<f:validateLength minimum="1"/>
			</p:inputText>
			<h:outputText value="Fecha*:"/>
			<p:calendar required="true" requiredMessage="Requerido Fecha" mindate="18/05/15" id="fecha" value="#{eventosBean.fecha}" pattern="yyyy-MM-dd" mask="true" />
			<h:outputText value="Tipo Eventos:"/>
			<h:panelGroup>  
					<p:selectOneMenu required="true" styleClass="t" value="#{eventosBean.te}" requiredMessage="Requerido Evento">
						<f:selectItem  itemLabel="Seleccione...!!!!" itemValue="" />
						<f:selectItems value="#{eventosBean.listaEveTipo}" />
						<p:ajax
							listener="#{eventosBean.asignarTipoeve()}">
						</p:ajax>
					</p:selectOneMenu>
			</h:panelGroup>
			<h:outputText value="Capacidad:"/>
			<p:inputText  required="true" id="cap" value="#{eventosBean.cantidad}" requiredMessage="Requerido Capacidad">
			<f:validateLength minimum="1"/>
			</p:inputText>
			<h:outputText value="Imagen:"/>
			 <p:fileUpload mode="advanced" dragDropSupport="true" update=":form1:message1 :form1:imagen" sizeLimit="100000" 
    		allowTypes="/(\.|\/)(jpe?g)$/" cancelLabel="Cancelar" uploadLabel="Subir" label="Seleccionar" fileLimit="1" fileUploadListener="#{eventosBean.ImagenServ}"/>
   			 <h:outputText value="Vista Previa:"/>   			 
   			 <p:graphicImage id="imagen" value="/imgevent/#{eventosBean.imagen}" width="150" height="150" />
   			 <p:commandButton id="trackregistrar" style="width:100%" update=":form2:panel2 message1" value="Guardar Evento" action="#{eventosBean.crearEvento}">
   			 <p:tooltip id="toolTipTrac1" for="trackregistrar" value="Botón para Registrar Eventos" trackMouse="true" />
   			 </p:commandButton>
   			 <p:commandButton id="trackregistrar1" style="width:100%" update="panel1 message1" value="Crear Solicitud para el Evento" action="#{eventosBean.irSolicitud}">
   			 <p:tooltip id="toolTipTrac2" for="trackregistrar1" value="Botón para Crear Solicitud" trackMouse="true" />
   			 </p:commandButton>
		</p:panelGrid>
	</p:panel>
</h:form>
</div>
<div class="div2">
<h:form id="form2">
		<p:growl id="message2" showDetail="true" />
	<p:panel id="panel2" header="Lista de Eventos Registrados">
		<p:dataTable id="dt" value="#{eventosBean.listRegEventos}" rows="10" var="reg"
			paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
                 paginator="true">			
			<p:column  headerText="NOMBRE">
				<h:outputText value="#{reg.nombre}"></h:outputText>
			</p:column>			
			<p:column headerText="DESCRIPCION">
				<h:outputText value="#{reg.descripcion}"></h:outputText>
			</p:column>
			<p:column headerText="DIRECCIÓN">
				<h:outputText value="#{reg.lugar}"></h:outputText>
			</p:column>
			<p:column headerText="COSTO">
			<h:outputText value="#{reg.costo}"></h:outputText>
			</p:column>
			<p:column headerText="FECHA">
			<h:outputText value="#{reg.fecha}" pattern="yyyy-MM-dd"/>
			</p:column>	
			<p:column id="f3" filterBy="#{reg.tipoevento.descripcion}" headerText="TIPO EVENTO">
			<h:outputText value="#{reg.tipoevento.descripcion}"></h:outputText>
			</p:column>
			<p:column headerText="CAPACIDAD">
			<h:outputText value="#{reg.cantidad}"></h:outputText>
			</p:column>
			<p:column headerText="IMAGEN">
			<p:commandLink update=":form2:imagen1" oncomplete="PF('imagendlg').show()" title="asd">
                    <h:outputText styleClass="ui-icon ui-icon-search" style="margin:0 auto;" />
                    <f:setPropertyActionListener value="#{reg.imagen}" target="#{reg.imagen}" />
                </p:commandLink>
			<p:commandButton id="trackimagen" update=":form2:imggi" value="Ver Imagen" actionListener="#{eventosBean.changeImg(reg.imagen)}" oncomplete="PF('imagendlg').show();">
			<p:tooltip id="toolTipTrac3" for="trackimagen" value="Botón para ver Imagen" trackMouse="true" />
			</p:commandButton>
			</p:column>		
			<p:column headerText="OPCIONES" exportable="false">
				<p:commandButton id="trackeditar" icon="ui-icon-pencil" >
				<p:tooltip id="toolTipTrack4" for="trackeditar" value="Botón para observar la Información del Evento" trackMouse="true" />
				<p:ajax listener="#{eventosBean.CargarEventos(reg)}" update=":form2:panel2" oncomplete="PF('dlg1').show();" />
				</p:commandButton>			
			</p:column>
		</p:dataTable>		
		<p:dialog header="Imagen" modal="true" closeOnEscape="true"  showEffect="fade" hideEffect="fade" resizable="false" widgetVar="imagendlg" id="imagendlg">
        	 <p:outputPanel id="imagen1">
            <p:panelGrid  columns="1" >
                <f:facet name="header">
        		<p:graphicImage value="/imgevent/#{eventosBean.imagen}" id="imggi"></p:graphicImage>
        		</f:facet>
        		  </p:panelGrid>
        	</p:outputPanel>
   		</p:dialog>					
		<br/>  	    
		<p:dialog widgetVar="dlg1" modal="true" closable="true" closeOnEscape="true"  header="Información Eventos" showEffect="clip" hideEffect="clip">
		<p:panelGrid  columns="2" >
		<h:outputText value="Nombre:"/>
			<p:inputText   id="nombre" value="#{eventosBean.nombre}" ></p:inputText>
			<h:outputText value="Descripción:"/>
			<p:inputText  id="descr" value="#{eventosBean.descripcion}" ></p:inputText>
			<h:outputText value="Dirección:"/>
			<p:inputText id="direc" value="#{eventosBean.lugar}" ></p:inputText>			
			<h:outputText value="Costo:"/>
			<p:inputText  id="costo" value="#{eventosBean.costo}" ></p:inputText>
			<h:outputText value="Fecha:"/>
			<p:calendar required="true" requiredMessage="Requerido Fecha" id="fecha" value="#{eventosBean.fecha}" pattern="yyyy-MM-dd" mask="true" />
			<h:outputText value="Tipo Evento:"/>
			<h:outputText  id="tev" value="#{eventosBean.tipoevento.tipo}"></h:outputText>
			<h:outputText value="Capacidad:"/>
			<p:inputText  id="cap" value="#{eventosBean.cantidad}"></p:inputText>	
			<h:outputText value="Imagen:"/>
			<p:fileUpload mode="advanced" dragDropSupport="true" update="imagen" sizeLimit="100000" 
    		allowTypes="/(\.|\/)(jpe?g)$/" cancelLabel="Cancelar" uploadLabel="Subir" label="Seleccionar" fileLimit="1" fileUploadListener="#{eventosBean.ImagenServ}"/>
   			 <h:outputText value="Vista Previa:"/>   			 
   			 <p:graphicImage id="imagen" value="/imgevent/#{eventosBean.imagen}" width="150" height="150" />	
   			<p:commandButton id="trackeditarev"  style="width:100%"  styleClass="ui-icon-search" value="Editar Evento" action="#{eventosBean.EditarEvento}" update=":form2:panel2 :form2:message2">
   			<p:tooltip id="toolTipTrack5" for="trackeditarev" value="Botón para Editar Evento" trackMouse="true" />
   			</p:commandButton>
		</p:panelGrid>
		</p:dialog>
			
	</p:panel>	
</h:form>
</div>
<div class="div4">
<!-- h:graphicImage id="img1" value="/resources/img/logo.png"></h:graphicImage-->
</div>
</body>
</html>