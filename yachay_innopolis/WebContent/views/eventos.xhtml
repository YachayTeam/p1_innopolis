<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:p="http://primefaces.org/ui" 
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html">
<h:head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<h:outputStylesheet library="css" name="styleser.css" />
<title>Crear Eventos</title>
</h:head>
<body>
<h:form enctype="multipart/form-data">  
    <p:menubar>
        <p:menuitem value="Eventos" action="#{recursosBean.irRec}" icon="ui-icon-clipboard" />
        <p:menuitem value="Crear Eventos" action="#{recursosBean.irTrecurso}" icon="ui-icon-pencil" />
        <p:menuitem value="Tipo Evento" action="#{recursosBean.irTrecurso}" icon="ui-icon-pencil" />
        <f:facet name="options">
            <p:commandButton type="button" value="Salir" icon="ui-icon-home" />
        </f:facet>
    </p:menubar>
</h:form>
<hr/>
<div class="div1">
<h:form id="form2">
	<p:growl id="message" showDetail="true" />
	<p:panel id="panel2"  header="Registro de Eventos">
		<p:panelGrid  columns="2" >
			<h:outputText value="Nombre*:"/>
			<p:inputText styleClass="t" required="true" id="nom" value="#{eventosBean.nombre}" requiredMessage="Requerido nombre">
				<p:ajax  listener="#{eventosBean.asignarNombreImg}" />
			</p:inputText>
			<h:outputText value="Descripción:"/>
			<p:inputTextarea styleClass="t" required="true" id="can" value="#{eventosBean.descripcion}" requiredMessage="Requerido Descripcion">
			<f:validateLength minimum="10"/>
			</p:inputTextarea>
			<h:outputText value="Dirección:"/>
			<p:inputText styleClass="t" required="true" id="des" value="#{eventosBean.lugar}" requiredMessage="Requerido Dirección"></p:inputText>
			<h:outputText value="Costo:"/>
			<p:inputText styleClass="t" required="true" id="lug" value="#{eventosBean.costo}" requiredMessage="Requerido Costo">
			<f:validateLength minimum="1"/>
			</p:inputText>
			<h:outputText value="Fecha*:"/>
			<p:calendar required="true" requiredMessage="Requerido Fecha" id="fecha" value="#{eventosBean.fecha}" pattern="yyyy-MM-dd" mask="true" />
			<h:outputText value="Tipo Eventos:"/>
			<h:panelGroup>  
					<p:selectOneMenu required="true" styleClass="t" value="#{eventosBean.te}" requiredMessage="Requerido Evento">
						<f:selectItem  itemLabel="Seleccione...!!!!" itemValue="" />
						<f:selectItems value="#{eventosBean.listaEveTipo}" />
						<p:ajax
							listener="#{eventosBean.asignarTipoeve()}">
						</p:ajax>
					</p:selectOneMenu>
			</h:panelGroup>
			<h:outputText value="Capacidad:"/>
			<p:inputText styleClass="t" required="true" id="cap" value="#{eventosBean.cantidad}" requiredMessage="Requerido Capacidad">
			<f:validateLength minimum="1"/>
			</p:inputText>
			<h:outputText value="Imagen:"/>
			 <p:fileUpload mode="advanced" dragDropSupport="true" update=":form2:message :form2:imagen" sizeLimit="100000" 
    		allowTypes="/(\.|\/)(jpe?g)$/" cancelLabel="Cancelar" uploadLabel="Subir" label="Seleccionar" fileLimit="1" fileUploadListener="#{eventosBean.ImagenServ}"/>
   			 <h:outputText value="Vista Previa:"/>   			 
   			 <p:graphicImage id="imagen" value="/imgevent/#{eventosBean.imagen}" width="150" height="150" />
   			 <p:commandButton style="width:100%" update=":form1:panel" value="Guardar Evento" action="#{eventosBean.crearEvento}">
   			 </p:commandButton>
   			 <p:commandButton style="width:100%" update="panel2 message" value="Crear Solicitud para el Evento" action="#{eventosBean.irSolicitud}">
   			 </p:commandButton>
		</p:panelGrid>
	</p:panel>
</h:form>
</div>
<div class="div2">
<h:form id="form1">
		<p:growl id="message2" showDetail="true" />
	<p:panel id="panel" header="Lista de Registrados">
		<p:dataTable id="dt" value="#{eventosBean.listRegEventos}" rows="10" var="reg"
			paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
                 paginator="true">			
			<p:column  headerText="NOMBRE">
				<h:outputText value="#{reg.nombre}"></h:outputText>
			</p:column>			
			<p:column headerText="DESCRIPCION">
				<h:outputText value="#{reg.descripcion}"></h:outputText>
			</p:column>
			<p:column headerText="DIRECCIÓN">
				<h:outputText value="#{reg.lugar}"></h:outputText>
			</p:column>
			<p:column headerText="COSTO">
			<h:outputText value="#{reg.costo}"></h:outputText>
			</p:column>
			<p:column headerText="FECHA">
			<h:outputText value="#{reg.fecha}"></h:outputText>
			</p:column>	
			<p:column id="f3" filterBy="#{reg.tipoevento.descripcion}" headerText="TIPO EVENTO">
			<h:outputText value="#{reg.tipoevento.descripcion}"></h:outputText>
			</p:column>
			<p:column headerText="CAPACIDAD">
			<h:outputText value="#{reg.cantidad}"></h:outputText>
			</p:column>
			<p:column headerText="IMAGEN">
			<p:commandButton value="Ver Imagen" actionListener="#{eventosBean.changeImg(reg)}" update="form1:panel" oncomplete="PF('imagendlg').show();"></p:commandButton>
			</p:column>		
			<p:column headerText="OPCIONES" exportable="false">
				<p:commandButton  icon="ui-icon-pencil" id="track">
				<p:tooltip id="toolTipTrack1" for="track" value="Botón para observar la Información del Registro" trackMouse="true" />
				<p:ajax listener="#{loginBean.Cargarusuarios(reg)}" update=":imggi" oncomplete="PF('dlg1').show();" />
				</p:commandButton>			
			</p:column>
		</p:dataTable>
		
		<p:dialog header="Imagen" modal="true" showEffect="fade" hideEffect="fade" resizable="false" widgetVar="imagendlg" id="imagendlg">
        	<p:graphicImage value="/imgevent/#{eventosBean.imagen}" id="imggi"></p:graphicImage><!-- :form1:panel -->
   		</p:dialog>
		<p:dialog widgetVar="dlg1" modal="true" closable="false" closeOnEscape="true"  header="Información" showEffect="clip" hideEffect="clip">
		<p:panelGrid columns="3" >
			<h:outputText value="Apellido: "/>
			<h:outputText value="#{loginBean.apellido}"></h:outputText>
			<h:outputText value=""/>
			<h:outputText value="Nombre: "/>
			<h:outputText value="#{loginBean.nombre}"></h:outputText>
			<h:outputText value=""/>
			<h:outputText value="Correo: "/>
			<p:inputText required="false" id="correo" requiredMessage="Por favor Ingrese su Correo." validatorMessage="Formato de correo invalido" value="#{loginBean.correo}">
			<f:validateRegex pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
			</p:inputText>			
			<h:outputText value=""/>
			<h:outputText value="Alias: "/>
			<h:outputText value="#{loginBean.alias}"></h:outputText>
			<h:outputText value=""/>
			<h:outputText value="Password: "/>
			<p:inputText required="false" id="pass" value="#{loginBean.password}" requiredMessage="Requerido" validatorMessage="Ingrese el password">
			<f:validateRegex pattern="[a-zA-Z ñíóúéáÑÁÉÍÓÚ]+"/>
			</p:inputText>
			<h:outputText value=""/>
			<h:outputText value="Seleccione tipo: " for="advanced"/>      		 
            <p:selectOneListbox  value="#{loginBean.arrayTipoLogin}">
            <f:selectItems value="#{loginBean.listaTipoLogin}" var="tipo" itemValue="#{loginBean.tipologin.idTipologin}"/>
        	</p:selectOneListbox>  
            <p:selectOneListbox   value="#{loginBean.arrayTipoLogin}">
            <f:selectItems value="#{loginBean.listaTipoLogin}" var="tipo" itemValue="#{loginBean.tipologin.idTipologin}"/>
        	</p:selectOneListbox>
        	<h:outputText value=""/>
        	<p:commandButton id="trackcambioadd" value="add" action="#{loginBean.crearUsuario}">
			<p:tooltip id="toolTipTrac7" for="trackcambioadd" value="Botón para Agregar" trackMouse="true" />
			</p:commandButton>
			<p:commandButton id="trackcambiodel" value="del" action="#{loginBean.crearUsuario}">
			<p:tooltip id="toolTipTrac6" for="trackcambiodel" value="Botón para Agregar" trackMouse="true" />
			</p:commandButton>	 
			<h:outputText value="Estado: "/>
			<h:outputText  id="est" readonly="true" value="#{loginBean.tipoestusr.nombreestado}"></h:outputText><br/>
			<p:commandButton update="message2" value="Actualizar" icon="ui-icon-refresh" onclick="PF('dlg1').close();"  action="#{loginBean.actualizarusuario}"></p:commandButton>													
			<p:commandButton value="Volver" icon="ui-icon-close" onclick="PF('dlg1').close();" update=":form1:panel :form1:message2" action="#{loginBean.irAprovador}"></p:commandButton>
		</p:panelGrid>
		</p:dialog>					
		<br/>  	    	
	</p:panel>
</h:form>
</div>
<div class="div4">
<!-- h:graphicImage id="img1" value="/resources/img/logo.png"></h:graphicImage-->
</div>
</body>
</html>